<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hack Day</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
    
        
    </script>
</head>
<body>
	<header>
		<h1><a href="index.html">MovieMatch</a></h1>
	</header>
	<div class="row">
		<div class="col-sm-8 col-sm-offset-2">
					<div class="input-group" id="searchin">
	   					<input class="form-control" type="text" id="search-bar" placeholder = "Search movies...">
	   					<span class="input-group-btn">
	   						<button class="btn btn-warning search-button" id="popular-button"><i class="glyphicon glyphicon-star"></i></button>
	   						<button class="btn btn-success search-button" id="theatre-button"><i class="glyphicon glyphicon-film"></i></button>
	   						<button class="btn btn-primary search-button" id="go-button"><i class="glyphicon glyphicon-search"></i></button>
	   					</span>
	   				</div>
	   	</div>
   	</div><br>
   	<div id="movie-container">

   	</div>

   <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
   <script src="js/bootstrap.min.js"></script>
   <script>
   		$('#go-button').on('click', searchForMovies);

   		function searchForMovies(){
   			var searchString = $('#search-bar').val();
   			console.log(searchString);
   			searchTitle(searchString);
   		}
	   	function searchTitle(title) {
			var result = "http://api.rottentomatoes.com/api/public/v1.0/movies.json?q=";
			result += title;
			result += "&page_limit=10&page=1&apikey=mhev5k6bwufz7q5drc9yk7nr";
			$(document).ready(function () {
		        $.ajax({
		            type: 'GET',
		            url: result,
		            dataType: 'jsonp',
		            success: function (data) {
		            	displayMovies(data.movies);
		            }
		        });
			});
		}
		function displayMovies(movieList){
			$('#movie-container').html('');
			movieList = movieList.sort(compareYear);
			for(var i=0; i< movieList.length; i++){
				console.log(movieList[i]);
				var current = movieList[i];
				var movieTitle = current.title;
				var movieYear = current.year;
				var movieSummary = current.synopsis;
				var audienceRating = current.ratings.audience_score;
				var criticRating = current.ratings.critics_score;
				var thePanel = '<div class="row"><div class="col-sm-8 col-sm-offset-2"><div class="panel panel-default movie-panel"> <div class="panel-heading movie-title"><h2>'+movieTitle+'('+movieYear+')</h2></div> <div class="panel-body movie-panel-body">'+movieSummary+'</div> </div> </div> </div>';
				$('#movie-container').append(thePanel);
			}
		}

		function compareYear(a,b) {
		  if (a.year < b.year)
		     return 1;
		  if (a.year > b.year)
		    return -1;
		  return 0;
		}


   </script>
</body>
</html>